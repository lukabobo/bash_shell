# Chapter 2: Script shebang

## Khái niệm shebang

Trong hệ thống Unix (Linux, macOS) shebang là dòng đầu tiên của một file script (file chạy được), dòng đó bắt đầu bằng cặp ký tự #!

Sau ký hiệu #! là tên chương trình thông dịch sẽ nạp và chạy code trong script, cú pháp như sau

    #!interpreter [optional-arg]

Trong đó:

`interpreter` là đường dẫn đến trình thông dịch
`[optional-arg]` các thiết lập nếu cần thiết, tùy thuộc vào interpreter

Shebang của trình thông dịch Shell (POSIX Shell)

- #!/bin/sh

Shebang của trình thông dịch BASH 

- #!/bin/bash
- #!/usr/bin/env bash

## 2.1. Env Shebang

Để thực thi một file script với tệp thực thi bash được tìm thấy trong biến môi trường PATH bằng cách sử dụng tệp thực thi env, dòng đầu tiên của file script phải chỉ ra đường dẫn tuyệt đối đến tệp thực thi env với đối số bash:

    #!/usr/bin/env bash

Đường dẫn env trong shebang được giải quyết và chỉ được sử dụng khi một tập lệnh được khởi chạy trực tiếp như thế này:

    script.sh

File script phải có quyền thực thi

Shebang bị bỏ qua khi trình thông dịch bash được chỉ định rõ ràng để thực thi một tập lệnh:

    bash script.sh

## 2.2. Shebang trực tiếp

Để thực thi file script với trình thông dịch bash, dòng đầu tiên của file script phải chỉ ra đường dẫn tuyệt đối đến bash thực thi để sử dụng:

    #!/bin/bash

Đường dẫn bash trong shebang được giải quyết và chỉ được sử dụng khi một script được khởi chạy trực tiếp như thế này:

    ./script.sh

Script phải có quyền thực thi

Shebang bị bỏ qua khi trình thông dịch bash được chỉ định rõ ràng để thực thi một tập lệnh:

    bash script.sh

## 2.3. Các shebang khác

Có hai loại chương trình mà kernel biết. Một chương trình nhị phân được xác định bằng tiêu đề ELF (ExtenableLoadableFormat), thường được tạo bởi trình biên dịch. Cái thứ hai là bất kỳ loại script nào.

Nếu một tệp bắt đầu ở dòng đầu tiên với chuỗi #! thì chuỗi tiếp theo phải là tên đường dẫn của trình thông dịch. Nếu kernel đọc dòng này, nó sẽ gọi trình thông dịch được đặt tên theo tên đường dẫn này và đưa ra tất cả các từ sau trong dòng này làm đối số cho trình thông dịch. Nếu không có tệp nào có tên sai:

    #!/bin/bash cai gi do tao lao
    echo "khong in duoc dong nay"

Trong /usr/bin/evn không có trình thông dịch cai gi do tao lao. Nên sẽ không in được.